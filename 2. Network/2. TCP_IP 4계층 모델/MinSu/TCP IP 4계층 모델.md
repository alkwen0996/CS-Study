# TCP/IP 4계층 모델

### 인터넷 프로토콜 스위트

인터넷에서 컴퓨터들이 서로 정보를 주고받는 데 쓰이는 프로토콜의 집합이다. 이를 TCP/IP 4계층 모델로 설명하거나 OSI 7계층 모델로 설명하곤 한다.

> 💡 **프로토콜** <br> 컴퓨터나 원거리 통신 장비 사이에서 데이터 교환 방식을 정의하는 규칙의 체계를 의미한다. 기기간 통신은 교환되는 데이터의 형식에 대해 상호 합의를 필요로 한다. 이런 형식을 정의하는 규칙의 집합을 프로토콜이라고 한다. 프로토콜은 상호간의 접속이나 전달방식, 통신방식, 오류 검출 방식 등을 규정하고 있다.

<br><br>

## 네트워크 계층구조

---

### 네트워크 계층구조 사용이유

네트워크 계층구조를 여러개로 구분하여 정의한 이유는 통신이 일어나는 과정을 단계별로 파악하며 통신 과정 중 문제 발생시 다른 단계의 장비 및 소프트웨어를 건드리지 않고 통신 장애를 일으킨 단계에서 해결할 수 있기 때문이다. 즉, 계층구조를 사용하는 목적은 분할정복 때문이라고 말할 수 있다.

<br><br>

## TCP/IP 4계층

---

### 애플리케이션 계층

HTTP, SMTP, FTP 등 응용 프로그램이 사용되는 프로토콜 계층이며, 웹 서비스, 이메일 등 서비스를 실질적으로 사용자들에게 제공하는 계층이다. 송수신측 사이에 주고 받는 서비스에 따라 애플리케이션 계층의 프로토콜이 달라진다.

<br>

### 전송 계층

송수신자를 연결하는 통신 서비스를 제공하며 연결 지향 데이터 스트림 지원, 신뢰성, 흐름제어를 제공할 수 있고 애플리케이션과 인터넷 계층 사이의 데이터가 전달될 때 중계역할을 한다.

> 💡 **가상회선 패킷 교환 방식** <br> 각 패킷에는 가상회선 식별자가 포함되며 모든 패킷을 전송하면 가상회선이 해제되고 패킷들은 전송된 순서대로 목적지에 도착하는 방식을 말한다.

> 💡 **데이터그램 패킷 교환 방식** <br> 패킷이 독립적으로 이동하며 최적의 경로를 선택하여 가는데, 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로로 전송될 수 있으며 **도착한 순서가 다를 수 있다.**

<br>

### 인터넷 계층

장치로부터 받은 네트워크 패킷을 IP주소로 지정된 목적지로 전송하기 위해 사용되는 계층이다. 패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달한다. 단, 수신측이 패킷을 수신했는지는 보장하지 않는 비연결형적인 특징을 가지고 있다.

<br>

### 링크 계층 (네트워크 접근 계층)

전선, 광섬유, 무선 등 하드웨어와 관련된 계층이며 실질적으로 데이터를 전달하며 장치간에 신호를 주고받는 “규칙”을 정한다.

<br><br>

## 계층간 데이터 송수신 과정

---

만약, 컴퓨터(송신자)를 통해 다른 컴퓨터(수신자)로 데이터를 요청한다면 어떤 과정을 거쳐 데이터가 전달될까?

![1.png](/2.%20Network/2.%20TCP_IP%204%EA%B3%84%EC%B8%B5%20%EB%AA%A8%EB%8D%B8/MinSu/img/1.png)

1. 애플리케이션 계층에서 전송 계층으로 사용자가 보내는 요청 값들이 캡슐화 과정을 거쳐 전달된다.
2. 링크 계층을 통해 해당 서버와 통신을 한다. (물리 계층을 통해 전기 신호로 수신측에 신호를 보낸다.)
3. 해당 서버의 링크 계층부터 애플리케이션 계층까지 비캡슐화 과정을 거쳐 데이터가 전송된다.

<br><br>

## 캡슐화 & 비캡슐화 과정

---

### 캡슐화 과정

캡슐화 과정은 상위 계층의 헤더와 데이터를 하위 계층의 데이터 부분에 포함시키고 해당 계층의 헤더를 삽입하는 과정을 말한다.

![2.png](/2.%20Network/2.%20TCP_IP%204%EA%B3%84%EC%B8%B5%20%EB%AA%A8%EB%8D%B8/MinSu/img/2.png)

1. 애플리케이션 계층의 데이터가 전송 계층으로 전달되면서 **세그먼트화, 데이터그램화** 되며 TCP(L4) 헤더가 붙여지게 된다.
2. 인터넷 계층으로 가면서 **패킷화** 되고 IP(L3)헤더가 붙는다.
3. 링크 계층으로 전달되면서 프레임 헤더와 프레임 트레일러가 붙어 **프레임화**가 된다.

> 💡 **해당 계층의 PDU** <br> 상위 계층의 데이터 + 해당 계층의 헤더

<br>

### 비캡슐화 과정

비캡슐화 과정은 하위 계층에서 상위 계층으로 가며 각 계층의 헤더 부분을 제거하는 과정을 말한다.

![3.png](/2.%20Network/2.%20TCP_IP%204%EA%B3%84%EC%B8%B5%20%EB%AA%A8%EB%8D%B8/MinSu/img/3.png)

캡슐화된 데이터를 링크계층에서 받게되면 상위 계층으로 올라가면서 각 계층의 헤더를 제거한다. 즉, **프레임 → 패킷 → 세그먼트, 데이터그램 → 메시지** 로 이어지는 비캡슐화 과정이 일어난다. 이후 최종적으로 애플리케이션의 PDU인 메시지로 사용자에게 전달된다.

<br><br>

## PDU(Protocol Data Unit)

---

### PDU란?

PDU란 각 계층에서 데이터가 전달될 때 한 덩어리의 단위를 말한다. PDU는 **제어 관련 정보들이 포함된** **헤더**와 **데이터를 의미하는 페이로드**로 구성되어 있으며 계층마다 부르는 명칭이 다르다.

![4.png](/2.%20Network/2.%20TCP_IP%204%EA%B3%84%EC%B8%B5%20%EB%AA%A8%EB%8D%B8/MinSu/img/4.png)

- 애플리케이션 계층 : 메시지
- 전송 계층 : 세그먼트(TCP), 데이터그램(UDP)
- 인터넷 계층 : 패킷
- 링크 계층 : 프레임(데이터 링크 계층), 비트(물리 계층)

<br>

> 💡 <span style="color:orange">참고!</span> <br> PDU 중 아래 계층인 비트로 송수신하는 것이 모든 PDU 중 가장 빠르고 효율성이 높다. 하지만, 애플리케이션 계층에서는 문자열을 기반으로 송수신을 하는데, 그 이유는 헤더에 authorization 값 등 다른 값들을 넣는 확장이 쉽기 때문이다.
